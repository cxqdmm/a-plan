{"version":3,"sources":["renderer/pages/dashboard/component/projectTable/module.js","renderer/redux/store.js","renderer/redux/observable.js","renderer/redux/module.js","renderer/redux/redux.js","renderer/redux/index.js"],"names":["Module","list","this","setState","projectList","observable","__webpack_exports__","_state","Symbol","Store","props","_this","Object","classCallCheck","processReducer","out","_modules","reduce","module","state","name","observableProps","forEach","prop","value","getPropValue","_useState","useState","_useState2","slicedToArray","setPropDispatch","modules","_context","context","newState","LazyInitializeSymbol","pendingDecorators","$store","cacheDescriptor","initializeInstance","target","decorators","key","addHiddenProp","d","propertyCreator","descriptor","object","propName","defineProperty","enumerable","writable","configurable","ObservableObjectAdministration","$value","Map","$dispatch","get","isImmutable","toJS","immutableValue","fromJS","set","dispatch","Error","concat","read","v","write","keys","initialValue","initializer","call","undefined","prototype","hasOwnProperty","adm","asObservableObject","addObservableProp","inheritedDecorators","assign","decoratorTarget","createPropertyInitializerDescriptor","apply","arguments","model","constructor","_module","setDispatch","setObservablePropDispatch","data","getOwnPropertyNames","console","log","createStore","dataModule","Array","isArray","elem","push","connect","component","item","flag","useContext","objectSpread","useRedux","store","Component","react_default","a","createElement","Provider","__webpack_require__","redux_useRedux","redux_connect"],"mappings":"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","file":"static/js/dashboard-component-projectTable-module.e3591d70.chunk.js","sourcesContent":["import { observable } from 'redux';\n\nclass Module {\n  @observable projectList = [];\n  setList(list) {\n    this.setState({\n      projectList: list,\n    })\n  }\n}\n\nexport default new Module();\n","import { useState } from 'react';\nconst _state = Symbol('state');\nexport default class Store {\n  constructor(props) {\n    this._context = props.context;\n    this[_state] = {};\n    this._modules = props.modules || [];\n  }\n  get context() {\n    return this._context;\n  }\n  get state() {\n    return this[_state];\n  }\n\n  set state(newState) {\n    if (newState !== this[_state]) {\n      this[_state] = newState;\n    }\n  }\n  /**\n   * @argument 该函数必须在函数式组件内部使用\n   */\n  processReducer = () => {\n    const out = this._modules.reduce((out, module) => {\n      out.state[module.name] = {};\n      module.observableProps.forEach(prop => {\n        let value = module.getPropValue(prop)\n        const [state, setState] = useState(value);\n        out.state[module.name][prop] = state;\n        module.setPropDispatch(prop, setState);\n      })\n      out.modules[module.name] = module.module;\n      return out;\n    }, {\n        state: {},\n        modules: {},\n      })\n    this.state = out.state;\n    this.modules = out.modules;\n  }\n}\n","\nimport { fromJS, isImmutable} from 'immutable';\nconst LazyInitializeSymbol = Symbol('lazy initialize symbol');\nconst pendingDecorators = Symbol('pending decorator');\nconst $store = Symbol('@proxy')\nlet cacheDescriptor = {};\n\nfunction createObservable(target, prop, descriptor) {\n  let decoratorFactory = createPropDecorator(function propertyCreator(target, prop, descriptor) {\n    var initialValue = descriptor\n      ? descriptor.initializer\n        ? descriptor.initializer.call(target)\n        : descriptor.value\n      : undefined;\n    asObservableObject(target).addObservableProp(prop, initialValue)\n  });\n  return decoratorFactory.apply(null, arguments);\n}\n\nfunction createPropDecorator(propertyCreator) {\n  return function decoratorFactory() {\n    let decorator = function decorate(target, prop, descriptor) {\n      if (!Object.prototype.hasOwnProperty.call(target, pendingDecorators)) {\n        var inheritedDecorators = target[pendingDecorators];\n        addHiddenProp(target, pendingDecorators, Object.assign({}, inheritedDecorators));\n      }\n      target[pendingDecorators][prop] = {\n        prop: prop,\n        propertyCreator: propertyCreator,\n        descriptor: descriptor,\n        decoratorTarget: target,\n      };\n      return createPropertyInitializerDescriptor(prop);\n    }\n    return decorator.apply(null, arguments);\n  }\n}\n// 返回初始的Descriptor\nfunction createPropertyInitializerDescriptor(prop) {\n  return (cacheDescriptor[prop] ||\n    (cacheDescriptor[prop] = {\n      configurable: true,\n      enumerable: true,\n      get: function () {\n        initializeInstance(this);\n        return this[prop];\n      },\n      set: function (value) {\n        initializeInstance(this);\n        this[prop] = value;\n      }\n    }));\n}\n\n// 该函数相当牛逼，用于修改实例属性的decorator 从 createPropertyInitializerDescriptor => propertyCreator,\n// 注册实例属性的代理\nfunction initializeInstance(target) {\n  if (target[LazyInitializeSymbol] === true)\n    return;\n  var decorators = target[pendingDecorators];\n  if (decorators) {\n    addHiddenProp(target, LazyInitializeSymbol, true);\n    for (var key in decorators) {\n      var d = decorators[key];\n      d.propertyCreator(target, d.prop, d.descriptor);\n    }\n  }\n}\n\nfunction addHiddenProp(object, propName, value) {\n  Object.defineProperty(object, propName, {\n    enumerable: false,\n    writable: true,\n    configurable: true,\n    value: value\n  });\n}\n\nfunction asObservableObject(target) {\n  if (Object.prototype.hasOwnProperty.call(target, $store))\n    return target[$store];\n  const adm = new ObservableObjectAdministration(target);\n  addHiddenProp(target, $store, adm);\n  return adm;\n}\n\n// 数据源的代理 代理内部管理数据\nclass ObservableObjectAdministration {\n  constructor(target) {\n    this.$value = new Map();\n    this.$dispatch = new Map();\n    this.target = target;\n  }\n  read(prop) {\n    let value = this.$value.get(prop);\n    if (isImmutable(value)) {\n      return value.toJS();\n    }\n    return value;\n  }\n  write(prop, value) {\n    let immutableValue = value;\n    if (!isImmutable(value)) {\n      immutableValue = fromJS(value)\n    }\n    this.$value.set(prop, immutableValue);\n    const dispatch = this.$dispatch.get(prop);\n    if (!dispatch) {\n      throw new Error(`${prop} is not observable, please use observable decorater to ${prop}`)\n    } \n    if (dispatch) {\n      dispatch(value);\n    }\n  }\n  addObservableProp(prop, value) {\n    // to do 添加enhancer 生成observableValue\n    let target = this.target;\n    //observableValue 实际上是一个proxy，可以很方便监控对象的任何行为\n    this.$value.set(prop, fromJS(value));\n    Object.defineProperty(target, prop, {\n      configurable: true,\n      enumerable: true,\n      get: function () {\n        return this[$store].read(prop);\n      },\n      set: function (v) {\n        this[$store].write(prop, v);\n      }\n    })\n  }\n  outputProps() {\n    return Object.keys(this.$value);\n  }\n  setDispatch(prop, dispatch) {\n    this.$dispatch.set(prop, dispatch);\n  }\n  getDispatch(prop) {\n    return this.$dispatch.get(prop);\n  }\n}\n\n// 监控属性值的操作，用proxy实现\n\nfunction getObservableProps(model) {\n  if (!model[pendingDecorators]) {\n    return [];\n  }\n  return Object.keys(model[pendingDecorators]);\n}\nfunction getObservablePropDispatch(model, prop) {\n  if (!model[$store]) {\n    throw new Error('model is not observable')\n  }\n  return model[$store].getDispatch(prop);\n}\nfunction setObservablePropDispatch(model, prop, dispatch) {\n  if (!model[$store]) {\n    throw new Error('model is not observable')\n  }\n  model[$store].setDispatch(prop, dispatch);\n}\n\nlet observable = createObservable;\n\nexport { observable, getObservableProps, setObservablePropDispatch, getObservablePropDispatch }\n","import { getObservableProps, setObservablePropDispatch } from './observable';\n/**\n * @argument 数据模块\n */\nexport default class Module {\n  constructor(module) {\n    this.name = module.constructor.name;\n    this._module = module;\n    // 被观察的属性\n    this.observableProps = getObservableProps(this._module);\n  }\n  getPropValue(prop) {\n    return this._module[prop];\n  }\n  setPropDispatch(prop, dispatch) {\n    if (!this._module.setState) {\n      this._module.setState = this.setState;\n    }\n    setObservablePropDispatch(this._module, prop, dispatch);   \n  }\n  setState(data) {\n    const props = Object.getOwnPropertyNames(data);\n    props.forEach(prop => {\n      console.log('dispatch => ',this.constructor.name, 'prop=',prop);\n      this[prop] = data[prop];\n\n    })\n  }\n  get module() {\n    return this._module;\n  }\n}","import React, { useContext } from 'react';\nimport Store from './store';\nimport Module from './module';\n\nconst Provider = (props) => {\n  const store = props.store;\n  store.processReducer();\n  return <store.context.Provider value={{ state: store.state, modules: store.modules }}>\n    {props.children}\n  </store.context.Provider>\n}\n\n/**\n * \n * @param {*} context \n * @param {*} dataModule \n * 这个函数用于建立store和数据模块的关联\n */\nfunction createStore(context, dataModule) {\n  let modules = [];\n  if (Array.isArray(dataModule)) {\n    dataModule.forEach(elem => {\n      if (typeof (elem) === 'object') {\n        elem.context = context;\n        modules.push(new Module(elem));\n      }\n    })\n  } else {\n    if (typeof (dataModule) === 'object') {\n      dataModule.context = context;\n      modules.push(new Module(dataModule));\n    }\n  }\n  return new Store({\n    context,\n    modules,\n  })\n}\n\n/**\n * @argument 关联dispatch 和 state 到 组件上\n * @param {*} context \n * @param {*} mapState \n * @param {*} mapDispatch \n */\nconst connect = modules => component => {\n  return function wrapComponent(props) {\n    let moduleArr = [].concat(modules);\n    let contextMap = moduleArr.reduce((out, item) => {\n      if (item.context) {\n        out.set(item.context,true);\n      }\n      return out;\n    }, new Map())\n    contextMap.forEach((flag, context) => {\n      useContext(context)\n    })\n    return component({ ...props});\n  }\n}\n\nconst useRedux = store => Component => {\n  return function Privider(props) {\n    store.processReducer();\n    return <store.context.Provider value={{ state: store.state, modules: store.modules }}>\n      <Component {...props}/>\n    </store.context.Provider>\n  }\n}\n\n\n\n\nexport {\n  useRedux,\n  Provider,\n  createStore,\n  connect,\n}","import { useRedux, Provider, createStore, connect } from './redux';\nimport { observable } from './observable';\n\nexport {\n  useRedux,\n  Provider,\n  createStore,\n  connect,\n  observable,\n}"],"sourceRoot":""}